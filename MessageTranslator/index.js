(function(o,u,r,e,R,i,p,s,c){"use strict";const{FormSelect:h,FormText:E}=i.Forms;s.storage.targetLanguage??="en";const y={en:"English",es:"Spanish",fr:"French",de:"German",it:"Italian",pt:"Portuguese",ru:"Russian",ja:"Japanese",ko:"Korean",zh:"Chinese (Simplified)"};function M(){return p.useProxy(s.storage),e.ReactNative.createElement(e.ReactNative.Fragment,null,e.ReactNative.createElement(E,null,"Configure your translation preferences"),e.ReactNative.createElement(h,{label:"Target Language",value:s.storage.targetLanguage,options:Object.entries(y).map(function(t){let[a,n]=t;return{label:n,value:a}}),onChange:function(t){return s.storage.targetLanguage=t}}))}const N="https://translate.googleapis.com/translate_a/single";async function T(t){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"en";try{const n=new URLSearchParams({client:"gtx",sl:"auto",tl:a,dt:"t",q:t}),l=await(await fetch(`${N}?${n}`)).json();return{translatedText:l[0][0][0],detectedLanguage:l[2]}}catch(n){throw console.error("Translation error:",n),n}}const{FormRow:m}=i.Forms,{Text:g,View:P}=i.General,w=r.findByProps("editMessage");function F(t){let{message:a,channelId:n,close:l}=t;const[f,v]=e.ReactNative.useState(""),[x,C]=e.ReactNative.useState(!0);e.ReactNative.useEffect(function(){async function _(){try{const B=await T(a.content);v(B.translatedText)}catch{v("Translation failed")}finally{C(!1)}}_()},[]);const L=function(){w.editMessage(n,a.id,{content:f}),l()};return e.ReactNative.createElement(P,{style:{padding:16}},e.ReactNative.createElement(g,{style:{color:c.semanticColors.HEADER_PRIMARY,fontSize:16,marginBottom:16}},`Original: ${a.content}`),x?e.ReactNative.createElement(g,{style:{color:c.semanticColors.HEADER_SECONDARY}},"Translating..."):e.ReactNative.createElement(e.ReactNative.Fragment,null,e.ReactNative.createElement(g,{style:{color:c.semanticColors.HEADER_PRIMARY,fontSize:16,marginBottom:16}},`Translated: ${f}`),e.ReactNative.createElement(m,{label:"Apply Translation",onPress:L})))}const S=r.findByProps("openMessageModal"),{showModal:A}=r.findByProps("showModal");let d;var b={onLoad:function(){d=S.openMessageModal.after(function(t){const a=t.args[0];t.result.props.children.props.children.push({label:"Translate",icon:R.createFileUrl("ic_translate"),onPress:function(){A({key:"translate-modal",modal:{children:function(){return e.ReactNative.createElement(F,{message:a,channelId:a.channel_id,close:function(){return r.findByProps("popModal").popModal()}})},closable:!0,title:"Translate Message"}})}})}),u.logger.log("Message Translator plugin loaded!")},onUnload:function(){d?.(),u.logger.log("Message Translator plugin unloaded.")},settings:M};return o.default=b,Object.defineProperty(o,"__esModule",{value:!0}),o})({},vendetta,vendetta.metro,vendetta.metro.common,vendetta.metro.common.assets,vendetta.ui.components,vendetta.storage,vendetta.plugin,vendetta.ui);
